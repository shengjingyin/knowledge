# 异步 I/O

通过回调的形式执行任务

![image-20220223165117936](https://gitee.com/sjy666666/image-host/raw/master/img/image-20220223165117936.png)

![image-20220223165315376](https://gitee.com/sjy666666/image-host/raw/master/img/image-20220223165315376.png)

前后端都是基于事件机制，事件的编程方式具有轻量级、松耦合、只关注事务点等优势，但是在多个异步任务的场景下，事件与事件之间各自独立，如何协作却又是一个问题

**单线程的最大好处：不用像多线程那样处处在意状态的同步问题，没有死锁的存在，也没有线程上下文切换所带来的性能上的开销**

单线程的弱点：

- 无法利用多核 CPU（是否可以使用多进程利用多核 CPU）
- 错误会导致整个应用退出，应用的健壮性值得考验
- 大量计算占用 CPU 导致无法继续调用异步 I/O

针对 Node 弱点的解决方案：

子进程（child_process）意味着 Node 可以从容的应对单线程在健壮性和无法利用多核 CPU 方面的问题。通过将计算分发到各个子进程，可以将大量计算分解掉，然后再通过进程之间的事件消息来传递结果，这可以很好地保持应用模型的简单和低依赖。通过 Master-Worker 的管理方式，也可以很好地管理各个工作进程，以达到更高的健壮性

### Node 应用场景

#### I/O 密集型

从单线程的角度讲，Node 擅长 I/O 密集型应用。Node 面向网络且擅长并行 I/O，能够有效的组织起更多的硬件资源，从而提供更好的服务。

I/O 密集的优势主要利用**事件循环**的处理能力，而不是启动每一个线程为每一个请求服务，资源占用极少。

### 是否不擅长 CPU 密集型业务

v8 的执行效率是十分高的

![image-20220223172909452](https://gitee.com/sjy666666/image-host/raw/master/img/image-20220223172909452.png)

<img src="https://gitee.com/sjy666666/image-host/raw/master/img/image-20220223173918908.png" alt="image-20220223173918908" style="zoom:150%;" />
